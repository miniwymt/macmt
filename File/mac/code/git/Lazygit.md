---
title : Lazygit
time : 2023-01-13 周五
tags : 
- git
- linux
- 
---

## 安装

```sh
brew install lazygit
```

## 热键与各页面区域下的常用操作热键

#### 全局热键

1. 区域切换

	- _**Tab**_
	- 左右键或 HL(Vim 中光标左右移动快捷键)
	- 1-5 分别对应状态区、工作区、暂存区、分支区、提交区、Stash 区

2. 系统命令

	- _**q**_ 退出
	- _**x**_ 强大的帮助面板
	 - ***Esc*** 取消操作

3. 区域内切换

	- `中括弧` 进行区域内的相关切换

#### 状态区

1. 主要显示当前路径、分支等信息

#### 工作区

1. 切换暂存状态

	- `空格` 切换选中文件的暂存状态
	- _**a**_ 切换所有文件的暂存状态
	- _**Enter**_ 进入文件对以行为单位的部分内容进行`空格`切换暂存状态
	    - 即只暂存某几行,而非暂存整个文件
	    - 如果对 vim 熟悉的话,还支持 shift+v 进入可视模式从而进行多选操作
	    - _**Esc**_ 退出文件

2. 文件编辑

	- _**e**_ 使用 nvim 编辑文件
	    - 默认使用的是 vim,参考[官方教程](https://github.com/jesseduffield/lazygit/blob/master/docs/Config.md) 修改默认配置
	- _**o**_ 使用 vscode 打开文件

3. 提交

	- _**c**_ 常规提交
	- _**C**_ 提交信息很长调用 vim 编辑提交信息后再提交
	- _**A**_ --amend 提交

4. 文件树

	- _**\`**_ 切换文件树视图
	- _**Enter**_ 展开或折叠目录

5. 忽略文件

	- _**i**_ 忽略操作
	    - _i_ 将文件添加到`.gitignore`
	    - _e_ 将文件从忽略跟踪目录中排除

6. 重置操作

	- _**g**_ 重置远程仓库HEAD操作
		- _s_ --soft 只重置本地版本库的 HEAD 到远程 HEAD
		- _m_ --mixed 重置本地 HEAD 和暂存区到远程 HEAD
		- _h_ --hard 重置 HEAD 与暂存区且重置工作区到远程 HEAD
	- _**d**_ 放弃更改(无论是否暂存)
	- _**D**_ 更多重置选项
		- _D_ 清空工作区
		- _u_ 放弃未暂存的更改
		- _c_ 丢弃未跟踪的文件 
		 - _s_ --soft 将本地版本库重置到本地 HEAD
		- _m_ --mixed 将暂存区重置到本地 HEAD
		- _h_ --hard 将工作区重置到本地 HEAD

7. Stash 操作

	- 当前文件未提交时无法切换分支但急需切换分支工作
	- _**s**_ 将文件进行 stash 存储
	- _**S**_ 打开 stash 菜单,更多 stash 选项

8. Diff操作

	- _**W**_ 更多diff选项


#### 分支区

1. 增删改查

	- _**n**_ 新建分支
	- _**R**_ 重命名分支
	- _**d**_ 删除分支
	- _**Enter**_ 查看当前分支下的提交记录

2. 合并与变基

- 本地分支
	- JK即上下方向键切换分支,空格确定当前分支
	- _**M**_ 将光标所在分支合并到当前分支
	- _**r**_ 将当前分支变基到光标所在分支
	- _**f**_ fetch 并 merge 上游分支到当前分支
- 远程分支
	- 增删改差自不说
	- 在确定本地仓库的当前分支的基础上合并与变基


#### 提交记录区

1. 提交栏

	- _s_ 将选中提交压缩到上一个提交,并合并提交信息
	- _f_ 将选中提交修正到上一次提交,并抛弃当前提交信息,只保留上一次提交的提交信息
	- _d_ 删除提交
	- _A_ 用已暂存的修改来修正选中的提交
	- _r_ 修改提交信息
		- _R_ 如果修改提交的信息很长,可使用编辑器进行修改提交
		- 对于已经推送过的节点进行修改提交后,再次推送需强制推送

2. reflog栏

	- _n_ 从某个提交节点创建一个新分支
	- _Ctrl+s_ 按路径(对于每个追踪文件而言,路径均不同)来过滤提交
	- 路径过滤后仍可配合 _W_ 打开 diff 选项查看差异

#### 主页面对应显示

1. 操作工作区时
	- 更改的暂存情况

2. 操作分支区时
	- 分支的历史提交

3. 操作提交区时

	- Patch补丁

#### Stash 区

1. Stash区的存在是为了方便分支切换

2. 处于A分支时在工作区贮藏未完成的文件到贮藏区

3. 切换到B分支处理急需的工作

4. 处理完毕后,切换回A分支,在贮藏区应用贮藏文件

## 进阶食用

#### _**rebase**_ 变基推送

1. 解决本地分支忘记pull落后与远程分支push失败的问题

	- 切换到分支区域,先确定本地分支(如要推送的为 master 分支)
	- 在分支区域中 _中括弧_ 切换到远程分支 master
	-  _**r**_ 将本地 master 变基到远程 master
	- 解决冲突再 push

#### _**rebase -i**_ 可视化变基修改提交历史

1. 切换到提交区域选择一个 commit 节点

	- _**e**_ 进入编辑提交

2. 对上方的节点进行一些rebase操作
	- _**s**_ squash 压缩(允许修改 commit 节点顺序,合并提交信息)
	- _**f**_ fixup 修复(对顺序有要求,抛弃 fixup 节点的提交信息)
	- _p_ pick 保持
	- _**d**_ drop 丢弃

3. _**m**_ 选择更多的 rebase 选项
	- _continue_ 确认继续 rebase, 如有冲突需解决冲突
	- _abort_ 撤销 rebase操作
	- _skip_ 高风险操作,会丢弃冲突commit再继续,不建议食用

#### _**merge conflict**_ 合并冲突

1. _**enter**_ 进入冲突文件

	- JK也即上下方向键选择冲突部分
	- _中括弧_ 跳转不同处的冲突
	- 空格选中要保留的部分
	- _b_ 冲突部分 both 保留

#### _**cherry-pick**_ 将分支节点拷贝到另一分支

1. 确认选中的分支(如 dev )

	- 切换到提交区域
	- _**c**_ 复制一个 commit 节点

2. 切换到分支区域并切换分支(如 master )

	- 空格选中 master 分支为当前分支 
	- 再切换到提交区域(切记)
	- _**v**_ 将从 dev 分支复制的节点 cherry-pick 到 master 分支 

#### _**Patch**_ 将已提交的修改中的一部分放入补丁进行移除或移动操作

1. 切换到提交区域

	- 选中需要修改的提交
	- 2次 _enter_ 进入具体提交
	- 空格选中具体几行修改(或vim用户可视化操作)进入 Patch 补丁
	- 2次 _ESC_ 退出补丁

2. 再选中一个要 Patch 操作的 commit 节点
	- _ctrl+p_ 进入 Patch 补丁操作选项菜单
	- 一个常用的操作是将一次提交内的部分内容 move 到另一次提交中

#### _**PR**_ 请原作者 `拉取` 被我们修改后的代码的`请求`

1. _**fork**_ 目标仓库到自己的远程仓库

2. 克隆 _**fork**_ 的仓库到本地

	- 修改
	- 提交
	- 推送

3. laztgit中创建 _**PR**_ 拉取请求

	- 在上述fork、clone、修改、提交、推送操作后
	- _**o**_ 创建拉取请求
	- _**O**_ 更多拉取请求选项

4. 如果我们被提 _**PR**_

	- 决定是否合并
	- 查看并解决冲突
	- 合并

